<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>画像縮小アプリ</title>
    <script src="https://cdn.jsdelivr.net/npm/stlite@latest/dist/stlite.js"></script>
  </head>
  <body>
    <div id="main"></div>
    <script>
      stlite.mount(
        {
          entrypoint: "streamlit_app.py",
          files: {
            "streamlit_app.py": `
import streamlit as st
from PIL import Image
import io

st.title("画像縮小アプリ（ローカル処理）")

uploaded_file = st.file_uploader("画像をアップロード", type=["jpg", "jpeg", "png"])
if uploaded_file:
    img = Image.open(uploaded_file)
    st.image(img, caption="元画像", use_column_width=True)

    width = st.slider("幅（px）", 50, img.width, int(img.width / 2))
    height = int(img.height * (width / img.width))
    resized_img = img.resize((width, height))

    st.image(resized_img, caption="縮小後", use_column_width=True)

    buf = io.BytesIO()
    resized_img.save(buf, format="PNG")
    byte_data = buf.getvalue()

    st.download_button("縮小画像をダウンロード", byte_data, file_name="resized.png", mime="image/png")
`
          }
        },
        document.getElementById("main")
      );
    </script>
  </body>
</html>
